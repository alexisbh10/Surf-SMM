{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Alexi/Documents/GitHub/Surf-SMM/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ElementRef } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport HLS from 'hls.js';\nimport OBSWebSocket from 'obs-websocket-js';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i4 from \"../sidebar/sidebar.component\";\nconst _c0 = [\"video\"];\nconst obs = new OBSWebSocket();\nexport class ObsComponent {\n  constructor(route, router, _http) {\n    this.route = route;\n    this.router = router;\n    this._http = _http;\n    this.url = \"\";\n    this.hls = new HLS();\n    this.user = 'HOME'; //TODO: User que se pasa por la url como parametro !\n\n    this.playing = false;\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.url = _this.router.url;\n      console.log(_this.url);\n      yield obs.connect('ws://192.168.1.131:4445', 'KksXWF5rcAInQJ83');\n    })();\n  }\n\n  startStreaming() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      obs.call('StartStream');\n      yield _this2.load('http://localhost:8000/live/STREAM_NAME/index.m3u8');\n    })();\n  }\n\n  stopStreaming() {\n    obs.call('StopStream');\n  }\n\n  load(currentVideo) {\n    if (HLS.isSupported()) {\n      this.loadVideoWithHLS(currentVideo);\n    } else {\n      console.log('Ups! no es soportado por tu navegador');\n    }\n  }\n\n  loadVideoWithHLS(currentVideo) {\n    this.hls.loadSource(currentVideo);\n    this.hls.attachMedia(this.video.nativeElement);\n  }\n\n}\n\nObsComponent.ɵfac = function ObsComponent_Factory(t) {\n  return new (t || ObsComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.HttpClient));\n};\n\nObsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ObsComponent,\n  selectors: [[\"app-obs\"]],\n  viewQuery: function ObsComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 7);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.video = _t.first);\n    }\n  },\n  decls: 16,\n  vars: 0,\n  consts: [[1, \"wrapper\"], [2, \"background\", \"white !important\"], [1, \"main\"], [1, \"navbar\", \"navbar-expand\", \"navbar-theme\"], [1, \"sidebar-toggle\", \"d-flex\", \"mr-2\"], [1, \"hamburger\", \"align-self-center\"], [1, \"content\"], [1, \"container-fluid\"], [1, \"row\"], [1, \"video-wrapper\", 2, \"margin-left\", \"50px\", \"margin-top\", \"15px\", \"width\", \"1190px\", \"height\", \"500px\"], [\"controls\", \"\", \"autoplay\", \"\", 1, \"video\", 2, \"width\", \"fit-content\", \"height\", \"500px\"], [\"video\", \"\"], [\"type\", \"button\", 3, \"click\"]],\n  template: function ObsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelement(1, \"app-sidebar\", 1);\n      i0.ɵɵelementStart(2, \"div\", 2)(3, \"nav\", 3)(4, \"a\", 4);\n      i0.ɵɵelement(5, \"i\", 5);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(6, \"main\", 6)(7, \"div\", 7)(8, \"div\", 8)(9, \"div\", 9);\n      i0.ɵɵelement(10, \"video\", 10, 11);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"button\", 12);\n      i0.ɵɵlistener(\"click\", function ObsComponent_Template_button_click_12_listener() {\n        return ctx.startStreaming();\n      });\n      i0.ɵɵtext(13, \"Start streaming\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"button\", 12);\n      i0.ɵɵlistener(\"click\", function ObsComponent_Template_button_click_14_listener() {\n        return ctx.stopStreaming();\n      });\n      i0.ɵɵtext(15, \"Stop streaming\");\n      i0.ɵɵelementEnd()()()()()();\n    }\n  },\n  dependencies: [i3.NgbNavbar, i4.SidebarComponent],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJvYnMuY29tcG9uZW50LmNzcyJ9 */\"]\n});","map":{"version":3,"mappings":";AAAA,SAAoBA,UAApB,QAAyD,eAAzD;AAEA,SAASC,UAAT,QAAwC,sBAAxC;AACA,OAAOC,GAAP,MAAgB,QAAhB;AACA,OAAOC,YAAP,MAA6E,kBAA7E;;;;;;;AACA,MAAMC,GAAG,GAAG,IAAID,YAAJ,EAAZ;AAOA,OAAM,MAAOE,YAAP,CAAmB;EAQvBC,YAAoBC,KAApB,EACUC,MADV,EAEUC,KAFV,EAE2B;IAFP;IACV;IACA;IATF,WAAc,EAAd;IACA,WAAM,IAAIP,GAAJ,EAAN;IAED,YAAsB,MAAtB,CAMoB,CANS;;IAC5B,eAAmB,KAAnB;EAKwB;;EAE1BQ,QAAQ;IAAA;;IAAA;MACZ,KAAI,CAACC,GAAL,GAAW,KAAI,CAACH,MAAL,CAAYG,GAAvB;MACAC,OAAO,CAACC,GAAR,CAAa,KAAI,CAACF,GAAlB;MACA,MAAMP,GAAG,CAACU,OAAJ,CAAY,yBAAZ,EAAuC,kBAAvC,CAAN;IAHY;EAIb;;EAEKC,cAAc;IAAA;;IAAA;MAClBX,GAAG,CAACY,IAAJ,CAAU,aAAV;MACA,MAAM,MAAI,CAACC,IAAL,CAAW,mDAAX,CAAN;IAFkB;EAGnB;;EAEMC,aAAa;IAClBd,GAAG,CAACY,IAAJ,CAAU,YAAV;EACD;;EAEMC,IAAI,CAACE,YAAD,EAAqB;IAC9B,IAAIjB,GAAG,CAACkB,WAAJ,EAAJ,EAAuB;MACrB,KAAKC,gBAAL,CAAsBF,YAAtB;IACD,CAFD,MAEO;MACLP,OAAO,CAACC,GAAR,CAAY,uCAAZ;IACD;EACF;;EAEOQ,gBAAgB,CAACF,YAAD,EAAqB;IAC3C,KAAKG,GAAL,CAASC,UAAT,CAAoBJ,YAApB;IACA,KAAKG,GAAL,CAASE,WAAT,CAAqB,KAAKC,KAAL,CAAWC,aAAhC;EACD;;AAtCsB;;;mBAAZrB,cAAYsB;AAAA;;;QAAZtB;EAAYuB;EAAAC;IAAA;;;;;;;;;;;;;;;MCZzBF;MACIA;MAEAA,+BAAkB,CAAlB,EAAkB,KAAlB,EAAkB,CAAlB,EAAkB,CAAlB,EAAkB,GAAlB,EAAkB,CAAlB;MAGIA;MACFA;MAIEA,gCAAsB,CAAtB,EAAsB,KAAtB,EAAsB,CAAtB,EAAsB,CAAtB,EAAsB,KAAtB,EAAsB,CAAtB,EAAsB,CAAtB,EAAsB,KAAtB,EAAsB,CAAtB;MAI4BA;MACFA;MAEAA;MAAsBA;QAAA,OAASG,oBAAT;MAAyB,CAAzB;MAA2BH;MAAeA;MAChEA;MAAsBA;QAAA,OAASG,mBAAT;MAAwB,CAAxB;MAA0BH;MAAcA","names":["ElementRef","HttpClient","HLS","OBSWebSocket","obs","ObsComponent","constructor","route","router","_http","ngOnInit","url","console","log","connect","startStreaming","call","load","stopStreaming","currentVideo","isSupported","loadVideoWithHLS","hls","loadSource","attachMedia","video","nativeElement","i0","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\Alexi\\Documents\\GitHub\\Surf-SMM\\frontend\\src\\app\\obs\\obs.component.ts","C:\\Users\\Alexi\\Documents\\GitHub\\Surf-SMM\\frontend\\src\\app\\obs\\obs.component.html"],"sourcesContent":["import { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport HLS from 'hls.js';\r\nimport OBSWebSocket, {OBSEventTypes, OBSRequestTypes, OBSResponseTypes} from 'obs-websocket-js';\r\nconst obs = new OBSWebSocket();\r\n\r\n@Component({\r\n  selector: 'app-obs',\r\n  templateUrl: './obs.component.html',\r\n  styleUrls: ['./obs.component.css']\r\n})\r\nexport class ObsComponent implements OnInit {\r\n  private url: string = \"\";\r\n  private hls = new HLS();\r\n  \r\n  public user: string | null = 'HOME' //TODO: User que se pasa por la url como parametro !\r\n  private playing: boolean = false;\r\n  @ViewChild('video', { static: true }) private readonly video: ElementRef<HTMLVideoElement> | any;\r\n\r\n  constructor(private route: ActivatedRoute,\r\n    private router: Router,\r\n    private _http: HttpClient) { }\r\n\r\n  async ngOnInit() {\r\n    this.url = this.router.url;\r\n    console.log (this.url)\r\n    await obs.connect('ws://192.168.1.131:4445', 'KksXWF5rcAInQJ83');\r\n  }\r\n\r\n  async startStreaming(){\r\n    obs.call ('StartStream')\r\n    await this.load ('http://localhost:8000/live/STREAM_NAME/index.m3u8')\r\n  }\r\n\r\n  public stopStreaming(){\r\n    obs.call ('StopStream')\r\n  }\r\n\r\n  public load(currentVideo: string): void {\r\n    if (HLS.isSupported()) {\r\n      this.loadVideoWithHLS(currentVideo);\r\n    } else {\r\n      console.log('Ups! no es soportado por tu navegador');\r\n    }\r\n  }\r\n\r\n  private loadVideoWithHLS(currentVideo: string) {\r\n    this.hls.loadSource(currentVideo);\r\n    this.hls.attachMedia(this.video.nativeElement);\r\n  }\r\n\r\n}\r\n","<div class=\"wrapper\">\r\n    <app-sidebar style=\"background: white !important;\"></app-sidebar>\r\n  \r\n    <div class=\"main\">\r\n        <nav class=\"navbar navbar-expand navbar-theme\">\r\n            <a class=\"sidebar-toggle d-flex mr-2\">\r\n        <i class=\"hamburger align-self-center\"></i>\r\n      </a>\r\n    \r\n          \r\n        </nav>\r\n        <main class=\"content\">\r\n            <div class=\"container-fluid\">\r\n                <div class=\"row\" >    \r\n                                  <div class=\"video-wrapper\" style=\"margin-left:50px;margin-top:15px;width:1190px;height:500px;\">\r\n                                    <video style=\"width:fit-content;height:500px;\"controls #video autoplay class=\"video\"></video>\r\n                                  </div>\r\n                                \r\n                                  <button type=\"button\" (click)=\"startStreaming()\">Start streaming</button>\r\n                                  <button type=\"button\" (click)=\"stopStreaming()\">Stop streaming</button>\r\n                </div>    \r\n            </div>\r\n        </main>\r\n        \r\n    </div>\r\n  </div>"]},"metadata":{},"sourceType":"module"}